
# 결제 페이지 구조 설명 (Payment Page Structure)

이 폴더에는 Aigongbu 플랫폼의 결제 프로세스와 결제 내역 관리를 위한 페이지 컴포넌트들이 포함되어 있습니다. 결제 시스템은 사용자가 강의를 구매할 수 있는 핵심 기능을 제공합니다.

## 폴더 구조

```
payment/
├── components/             # 결제 관련 UI 컴포넌트
│   ├── OrderSummary.tsx    # 주문 요약 컴포넌트 - 강의 정보, 가격 표시
│   ├── PaymentMethods.tsx  # 결제 수단 선택 컴포넌트 - 다양한 결제 방법 제공
│   ├── CheckoutSummary.tsx # 최종 결제 요약 컴포넌트 - 동의사항, 결제버튼 포함
│   └── README.md           # 컴포넌트 설명 문서
├── hooks/                  # 결제 관련 커스텀 훅
│   └── usePayment.ts       # 결제 기능 처리 로직 - 결제 API 연동 및 상태 관리
├── Checkout.tsx            # 메인 결제 페이지 - 결제 프로세스 진행
├── PaymentHistory.tsx      # 결제 내역 페이지 - 과거 결제 내역 조회
└── README.md               # 전체 결제 시스템 설명
```

## 파일 및 역할 설명

### 1. 메인 페이지

- **Checkout.tsx**: 
  - 결제 프로세스를 관리하는 메인 페이지입니다. 
  - 주문 요약, 결제 수단 선택, 최종 결제 섹션으로 구성되어 있습니다.
  - 각 섹션은 별도의 컴포넌트로 분리되어 있어 유지보수가 용이합니다.
  - 결제 정보의 상태 관리 및 결제 API 호출을 담당합니다.
  - 결제 성공/실패 후 적절한 페이지로 리디렉션합니다.

- **PaymentHistory.tsx**: 
  - 사용자의 과거 결제 내역을 조회하는 페이지입니다.
  - 테이블 형식으로 결제 날짜, 강의명, 금액, 결제상태 등을 표시합니다.
  - 필터링 기능을 통해 특정 기간이나 상태의 결제 내역만 조회할 수 있습니다.
  - 결제 상세 정보 조회 및 영수증 다운로드 기능을 제공합니다.

### 2. 컴포넌트

- **OrderSummary.tsx**: 
  - 구매하려는 강의의 정보와 가격을 표시합니다.
  - 강의 제목, 강사명, 총 강의 시간, 가격 등의 정보를 보여줍니다.
  - 할인 코드 입력 기능을 제공하여 할인된 가격을 계산합니다.
  - 최종 결제 금액을 계산하여 표시합니다.

- **PaymentMethods.tsx**: 
  - 사용자가 결제 수단을 선택할 수 있는 컴포넌트입니다.
  - 카카오페이, 신용카드, 무통장입금, 휴대폰 결제 등 다양한 결제 옵션을 제공합니다.
  - 각 결제 수단별 추가 정보 입력 폼을 동적으로 표시합니다.
  - 선택된 결제 수단 정보를 부모 컴포넌트에 전달합니다.

- **CheckoutSummary.tsx**: 
  - 최종 결제 금액, 이용약관 동의 체크박스, 결제하기 버튼을 포함한 컴포넌트입니다.
  - 필수 동의 사항(개인정보 처리방침, 환불 정책 등)을 확인합니다.
  - 모든 필수 동의 사항이 체크되었을 때만 결제 버튼을 활성화합니다.
  - '결제 완료하기' 버튼을 통해 최종 결제 프로세스를 시작합니다.

### 3. 커스텀 훅

- **usePayment.ts**: 
  - 결제 처리 로직을 분리한 커스텀 훅입니다.
  - 포트원(구 아임포트) API를 사용한 결제 처리와 결제 성공/실패 후의 처리 로직을 담당합니다.
  - 결제 진행 상태를 관리하고 결제 관련 에러를 처리합니다.
  - 백엔드 API와 통신하여 결제 정보를 저장합니다.
  - 결제 완료 후 사용자에게 알림을 표시합니다.

## 데이터 플로우

1. 사용자가 강의 상세 페이지에서 '수강신청' 버튼을 클릭하면 Checkout 페이지로 이동합니다.
2. 결제 페이지에서는 강의 정보를 확인하고, 결제 수단을 선택합니다.
3. 이용약관에 동의하고 '결제 완료하기' 버튼을 클릭하면 선택한 결제 수단에 따라 결제가 진행됩니다.
4. 결제 성공 시 백엔드 API를 통해 결제 정보를 저장하고 결제 완료 페이지로 이동합니다.
5. 결제 실패 시 에러 메시지를 표시하고 다시 시도하도록 안내합니다.
6. 사용자는 마이페이지의 '결제 내역' 메뉴를 통해 과거 결제 내역을 확인할 수 있습니다.

## 보안 고려사항

- 모든 결제 정보는 HTTPS를 통해 안전하게 전송됩니다.
- 카드 번호와 같은 민감한 정보는 클라이언트에 저장되지 않고 결제 대행사의 안전한 시스템을 통해 처리됩니다.
- 결제 요청은 사용자 인증 토큰 검증 후에만 처리됩니다.
